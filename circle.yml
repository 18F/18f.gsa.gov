machine:
  ruby:
    version:
      2.3.1

dependencies:
  pre:
    - bundle install
    # uncomment to restore pa11y-ci
    # - nvm install stable && nvm alias default stable
    #
    # uncomment to restore pa11y-ci
    # - npm install -g pa11y-ci
    #
    - npm install -g gulp
    - gem install scss_lint
    - gulp -v 
    - scss-lint -v
    - jekyll -v 
    - npm install -g accesslint-cli@1.1.1
    - gem install accesslint-ci -v 0.1.9
  override:
    - gulp build
    - bundle exec jekyll build
    - npm test 
   

    

test:
  pre:
    - bundle exec jekyll test
    - bundle exec htmlproofer _site --disable-external --allow-hash-href --empty-alt-ignore --url-ignore 18f@gsa.gov
    # uncomment to restore pa11y-ci
    # - npm run --harmony lint-508
  post:
    - ls -agolf _site/ # Ensure that build worked
    - |
      bundle exec jekyll serve --detach --no-watch && \
       accesslint-ci scan http://localhost:4000
